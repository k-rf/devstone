---
description: アクターモデルに基づいたサブエージェント定義のテンプレート。各セクションを記入してエージェントを定義します。
---

# {エージェント名} 定義書

## 1. アイデンティティ

### 役割（Role）

- **名前**: {エージェント名}
- **概要**: {一文での役割の説明}

### 目的（Purpose）

{このエージェントが存在する理由と達成すべきゴール}

### スコープ

**実施すること**:

- {このエージェントが行うこと}
- {...}

**実施しないこと**:

- {明示的に行わないこと}
- {...}

## 2. 契約（インターフェース）

### 入力仕様

受け取るメッセージの構造を定義します。

| フィールド | 型   | 必須 | 説明               |
| ---------- | ---- | ---- | ------------------ |
| {名前}     | {型} | {○}  | {フィールドの説明} |
| ...        | ...  | ...  | ...                |

### 出力仕様

返すメッセージの構造を定義します。

**成功時**:

| フィールド | 型   | 説明               |
| ---------- | ---- | ------------------ |
| {名前}     | {型} | {フィールドの説明} |
| ...        | ...  | ...                |

**失敗時**:

| フィールド | 型     | 説明             |
| ---------- | ------ | ---------------- |
| error      | 文字列 | エラーメッセージ |
| code       | 文字列 | エラーコード     |
| ...        | ...    | ...              |

### 前提条件

- {エージェントが動作するための前提条件}

### 事後条件

**成功時**:

- {成功時に保証される状態}

**失敗時**:

- {失敗時の状態保証}

## 3. 振る舞いの定義

### 責務

{このエージェントの単一責任}

### 成功条件

- [ ] {条件 1: 具体的で測定可能な条件}
- [ ] {条件 2: ...}

### 失敗条件

- [ ] {条件 1: どのような状態を失敗とみなすか}
- [ ] {条件 2: ...}

### エスカレーション条件

以下の場合、上位エージェントまたはユーザーに判断を委ねる：

- [ ] {条件 1: 自己判断できない状況}
- [ ] {条件 2: ...}

## 4. メッセージング

### 入力メッセージ形式

- **メッセージタイプ**: {メッセージタイプ名}
- **ペイロード**: 入力仕様で定義された構造

### 出力メッセージ

**成功時**:

- **メッセージタイプ**: {Success/Result}
- **ペイロード**: 出力仕様（成功時）で定義された構造

**失敗時**:

- **メッセージタイプ**: {Error/Failure}
- **ペイロード**: 出力仕様（失敗時）で定義された構造

### 副作用

- {状態変更する操作があれば記載}
- {なければ「副作用なし」と明記}

## 5. コンテキストと制約

### 前提条件

- {実行前に必要な状態や条件}

### 制約条件

- **時間制約**: {タイムアウト設定など}
- **リソース制約**: {メモリ、CPU、ネットワークなど}
- **権限制約**: {必要なアクセス権限}

### 依存関係

- **外部システム**: {API、データベースなど}
- **他エージェント**: {依存する他のエージェント}
- **データ依存**: {必要なデータソース}

## 6. 観測可能性（Observability）

### メトリクス

- `{メトリクス名}`: {何を測定するか、閾値など}

### ログ

**必須ログ**:

- 開始時: {ログ内容}
- 完了時: {ログ内容}
- エラー時: {ログ内容}

**デバッグログ**:

- {重要な中間状態}

### トレーシング

- {他エージェントとの相互作用の追跡方法}
- {分散トレーシング ID の使用など}

## 7. エラーハンドリング

### 失敗のパターン

| パターン     | 原因   | 対処法 |
| ------------ | ------ | ------ |
| {パターン 1} | {原因} | {対処} |
| {パターン 2} | {原因} | {対処} |

### リトライポリシー

- **対象エラー**: {どのエラーで再試行するか}
- **最大試行回数**: {N 回}
- **バックオフ戦略**: {Exponential/Linear/Fixed}
- **タイムアウト**: {最大実行時間}

### フォールバック戦略

- {プライマリが失敗した場合の代替手段}

## 8. セキュリティと権限

### アクセス権限

**必要な権限**:

- {読み取り/書き込み権限}
- {API アクセス}
- {...}

**機密情報の扱い**:

- {センシティブデータの処理方法}
- {ログに含めない情報}
- {暗号化要件}

## 9. テストとバリデーション

### テストケース

**正常系**:

- [ ] {テストケース 1}
- [ ] {テストケース 2}

**異常系**:

- [ ] {エラーケース 1}
- [ ] {エラーケース 2}

**境界値**:

- [ ] {境界値テスト 1}

### バリデーション

- {入力バリデーションのルール}
- {出力バリデーションのルール}

## 10. 実装ガイドライン

### 推奨アプローチ

{実装時の推奨パターンや設計方針}

### アンチパターン

{避けるべき実装パターン}

### 参考実装

実装言語は問いません。疑似コードや具体的な言語（TypeScript、Python など）での実装例を記載してください。

```ts
// 疑似コードまたは参考実装
```
